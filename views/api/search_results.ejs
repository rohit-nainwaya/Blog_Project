<% layout('layouts/boilerplate2') %>
<body>
    <!-- Hero Section -->
    <div class="hero-section">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h1 class="hero-title">Search Results</h1>
            <p class="hero-subtitle">Found results for "<%= query %>"</p>
        </div>
    </div>

    <!-- Filter & Sort Section -->
    <div class="container mt-4">
        <div class="filter-bar">
            <div class="row g-3 align-items-center">
                <div class="col-md-3">
                    <select class="form-select filter-select" id="mediaType">
                        <option value="all">All Results</option>
                        <option value="movie">Movies Only</option>
                        <option value="tv">TV Shows Only</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <select class="form-select filter-select" id="sortBy">
                        <option value="popularity">Sort by Popularity</option>
                        <option value="rating">Sort by Rating</option>
                        <option value="title">Sort by Title</option>
                        <option value="release_date">Sort by Date</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <div class="results-count">
                        <i class="fas fa-search"></i>
                        <span id="resultsCount">Loading...</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="view-toggle">
                        <button class="view-btn active" data-view="grid">
                            <i class="fas fa-th"></i>
                        </button>
                        <button class="view-btn" data-view="list">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container-fluid px-0">
        <div class="container mt-4">
            <!-- Loading Skeleton -->
            <div id="loadingSkeleton" class="movie-grid">
                <div class="skeleton-card" style="--delay: 0s;"></div>
                <div class="skeleton-card" style="--delay: 0.1s;"></div>
                <div class="skeleton-card" style="--delay: 0.2s;"></div>
                <div class="skeleton-card" style="--delay: 0.3s;"></div>
                <div class="skeleton-card" style="--delay: 0.4s;"></div>
                <div class="skeleton-card" style="--delay: 0.5s;"></div>
            </div>

            <!-- Results Grid -->
            <div class="movie-grid" id="resultsGrid"></div>

            <!-- Details Modal -->
            <div id="movieDetails" class="modal-overlay hidden">
                <div class="modal-content-wrapper">
                    <button id="closeDetails" class="modal-close" onclick="goBack()">
                        <i class="fas fa-times"></i>
                    </button>
                    
                    <div class="detail-backdrop"></div>
                    
                    <div class="detail-content">
                        <div class="container">
                            <div class="row g-4">
                                <!-- Poster Column -->
                                <div class="col-lg-4">
                                    <div class="poster-wrapper">
                                        <img id="itemPoster" src="/assets/home_page/alt.jpg" alt="poster" class="detail-poster">
                                        <div class="rating-badge">
                                            <i class="fas fa-star"></i>
                                            <span id="ratingBadge">0</span>
                                        </div>
                                        <div class="media-type-badge" id="mediaTypeBadge"></div>
                                    </div>
                                    
                                    <div class="action-buttons mt-3">
                                        <a id="ottLink" href="#" class="btn-custom btn-primary" target="_blank">
                                            <i class="fas fa-play"></i> Watch Now
                                        </a>
                                        <button class="btn-custom btn-secondary" onclick="goBack()">
                                            <i class="fas fa-arrow-left"></i> Back
                                        </button>
                                    </div>

                                    <div class="movie-stats mt-4">
                                        <div class="stat-item" id="statRuntime">
                                            <i class="fas fa-clock"></i>
                                            <span id="itemRuntime"></span>
                                        </div>
                                        <div class="stat-item" id="statSeasons" style="display:none;">
                                            <i class="fas fa-tv"></i>
                                            <span id="itemSeasons"></span>
                                        </div>
                                        <div class="stat-item" id="statEpisodes" style="display:none;">
                                            <i class="fas fa-film"></i>
                                            <span id="itemEpisodes"></span>
                                        </div>
                                        <div class="stat-item">
                                            <i class="fas fa-calendar"></i>
                                            <span id="itemDate"></span>
                                        </div>
                                        <div class="stat-item">
                                            <i class="fas fa-globe"></i>
                                            <span id="itemCountry"></span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Info Column -->
                                <div class="col-lg-8">
                                    <div class="movie-header">
                                        <h1 id="movieTitle" class="movie-title"></h1>
                                        <div class="movie-meta">
                                            <span id="itemGenres" class="genres"></span>
                                        </div>
                                    </div>

                                    <p id="movieDescription" class="movie-description"></p>

                                    <div class="movie-credits">
                                        <div class="credit-item" id="creditDirector">
                                            <span class="credit-label">Director:</span>
                                            <span id="itemDirector" class="credit-value"></span>
                                        </div>
                                        <div class="credit-item" id="creditCreator" style="display:none;">
                                            <span class="credit-label">Created By:</span>
                                            <span id="itemCreator" class="credit-value"></span>
                                        </div>
                                        <div class="credit-item">
                                            <span class="credit-label">Production:</span>
                                            <span id="itemProduction" class="credit-value"></span>
                                        </div>
                                    </div>

                                    <!-- Trailer Section -->
                                    <div class="section-block trailer-section">
                                        <h3 class="section-title">
                                            <i class="fas fa-film"></i> Trailer
                                        </h3>
                                        <div class="iframe-container">
                                            <iframe id="movieTrailer" src="" allowfullscreen></iframe>
                                        </div>
                                    </div>

                                    <!-- Cast Section -->
                                    <div class="section-block">
                                        <h3 class="section-title">
                                            <i class="fas fa-users"></i> Cast
                                        </h3>
                                        <div id="castList" class="cast-carousel"></div>
                                    </div>

                                    <!-- Where to Watch -->
                                    <div class="section-block">
                                        <h3 class="section-title">
                                            <i class="fas fa-tv"></i> Where to Watch
                                        </h3>
                                        <div id="watchProvidersList" class="providers-list"></div>
                                    </div>

                                    <!-- Similar Content -->
                                    <div class="section-block">
                                        <h3 class="section-title">
                                            <i class="fas fa-heart"></i> Similar Content
                                        </h3>
                                        <div id="similarRow" class="similar-carousel"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Pass query parameter to JavaScript
        const query = "<%= query %>";
    </script>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.7/dist/axios.min.js"></script>
    <script src="/JS/search_results.js"></script>
</body>
</html>